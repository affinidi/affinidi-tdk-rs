<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <title>Affinidi Peer DID example</title>
    <style>
        #resolve-result {
            display: none;
            border: 1px solid black;
            overflow: auto;
        }

        #create-result-did,
        #create-result-keys {
            display: none;
            border: 1px solid black;
            overflow: auto;
        }

        code {
            display: inline-block;
            width: 60%;
            background-color: lightgray;
            overflow: auto;
            border: 1px solid black;
            word-wrap: break-word;
        }
    </style>
</head>

<body onload="initialize()">
    <script type="module" src="/did-peer.js"></script>

    <div>
        <h2>Resolve <a href="https://identity.foundation/peer-did-method-spec/" target="_blank">Peer DID</a></h2>
        <p style="color: red;"><b>NOTE:</b><i>Only DID:peer:2. (method type 2) is supported.</i></p>
        <hr>
        <table style="table-layout:fixed; width:90%;overflow: auto;">
            <tr>
                <td>
                    <form>
                        <label for="did_resolve"><b>DID:</b></label>&ensp;<input type="text" id="did_resolve"
                            name="did_resolve" style="width:70%" placeholder="did:peer:2.">&ensp;<button value="resolve"
                            type="button" onclick="resolveDID()">Resolve</button>
                    </form>
                </td>
            </tr>
            <tr>
                <td>
                    <h3>Resolver Result :: <button onclick="clearBox('resolve-result')">Clear Result</button></h3>
                </td>
            </tr>
            <tr>
                <td id="resolve-result">
                </td>
            </tr>
        </table>
    </div>
    <hr>
    <div>
        <h2>Create a DID:peer</h2>

        To create a new DID:peer, you need to provide at least one key. You can add more keys and services if
        needed.<br>
        <b>NOTE:</b> <i>Only DID:peer:2. (method type 2) is supported.</i>

        <h3>Keys</h3>

        DID:peer supports two types of keys: Verification and Encryption. You can add multiple keys of each type.
        <br><br>
        <table style="margin-left:10px">
            <tr>
                <td>
                    <li><b>Verification</b></li>
                </td>
                <td>- Appears in the DID Document authentication and assertionMethod fields</td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <li><i>Recommend Ed25519 key type for signing</i></li>
                </td>
            </tr>
            <tr>
                <td>
                    <li><b>Encryption</b></li>
                </td>
                <td>- Appears in the DID Document keyAgreement field</td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <li><i>Recommend Secp256K1 key type for encryption, supports recryption capabilities</i></li>
                </td>
            </tr>
        </table>
        <br>
        You can specify an existing Multibase Public Key if already created (i.e. for example did:key:(z6Mk...)).
        <br>If left blank, keys will be autogenerated and private keys shown below.<br>
        <p style="color: red;">
            <b>Important:</b> For DIDComm you must create a new DID:peer with at least one Verification and
            one Encryption key.
        </p>
        <b>NOTE:</b> <i>The order of these keys reflects the key identifier names used!</i><br>
        <b>NOTE:</b> <i>For simplicity auto-generated keys are Ed25519 based. EdDSA + Curve25519</i>
        <br><br>
        <table id="new-keys">
            <tr>
                <th>Key ID</th>
                <th>Purpose</th>
                <th>Type</th>
                <th>Multibase Public Key</th>
                <th></th>
            </tr>
        </table>
        <h3>Services</h3>

        DID:peer allows you to specify service statements that can be used for example to describe how DIDComm messages
        can be sent to a mediator service. You can specify multiple services.
        <br><br>
        <table style="margin-left:10px">
            <tr>
                <td>
                    <li><b>Type</b></li>
                </td>
                <td>- Defaults to <b><i>DIDCommMessaging</i></b></td>
            </tr>
            <tr>
                <td>
                    <li><b>URI</b></li>
                </td>
                <td>- Service endpoint address E.g. (https://127.0.0.1:7037/)</td>
            </tr>
            <tr>
                <td>
                    <li><b>Accept</b></li>
                </td>
                <td>- Array of accepted message types for this service. Defaults to <b><i>didcomm/v2</i></b></td>
            </tr>
            <tr>
                <td>
                    <li><b>Routing Keys</b></li>
                </td>
                <td>- Array of DID public-keys that can be used for this defined service. Format must be
                    <b><i>did:method:identifier#key-id</i></b>
                </td>
            </tr>
        </table>
        <br>
        <b>NOTE:</b> <i>The order of these services reflects the service identifier names used!</i><br>
        <b>NOTE:</b> <i>All attributes are required in describing the service!</i><br>
        <b>NOTE:</b> <i>Separate multiple items in Arrays with '<b>;</b>'</i><br>
        <br>
        <table id="new-services">
        </table>
        <br>
        <button value="create_did" type="button" onclick="createDID()" style="background-color: lawngreen;">Create
            DID</button>
    </div>
    <br>
    <div id="create-result-did"></div>
    <br>
    <div id="create-result-keys"></div>
    <hr>
    <h2>Examples</h2>
    Alice wants to send a DIDComm message to Bob. Bob utilizes a DIDComm mediator to handle his incoming messages,
    this
    is described in Bob's DID Document via a defined service.

    <h3>Alice</h3>
    Alice represents herself with a Decentralized Identifier (DID) that contains the following:
    <ul>1. Verification key that is used for signing of messages for non-repudiation</ul>
    <ul>2. Encryption key that is used for encryption of messages that are sent to Alice</ul>
    <ul>3. Basic service definition that states she accepts DIDComm messaging directly</ul>
    <h4>Example Alice DID&ensp;<button onclick="copyDid('alice-did')">Copy DID</button></h4>
    <code id="alice-did">
        did:peer:2.Vz6MknrybrXop8wjecgH5gNZ4bajiztB1EuJ1aPJW1PsLaFcP.EzDnaeYzK9dTHipxp7QxvUADomBdLsSSvPsHBMc93g4BvSviHZ.SeyJ0IjoiZG0iLCJzIjp7InVyaSI6Imh0dHBzOi8vbG9jYWxob3N0OjcwMzcvIiwiYWNjZXB0IjpbImRpZGNvbW0vdjIiXSwicm91dGluZ19rZXlzIjpbXX19
    </code>
    <h3>Bob</h3>
    Bob represents himself with a Decentralized Identifier (DID) that contains the following:
    <ul>1. Verification key that is used for signing of messages for non-repudiation</ul>
    <ul>2. Encryption key that is used for encryption of messages that are sent to Bob</ul>
    <ul>3. Service definition that states he uses a DIDComm mediator to receive messages. He shares the public-key
        to
        use when communicating to the mediator</ul>
    <h4>Example Bob DID&ensp;<button onclick="copyDid('bob-did')">Copy DID</button></h4>
    <code id="bob-did">
        did:peer:2.Vz6MkfRViUo3fADYPnpQeyJLCgtGsMfwqSUcEq7Jx6VrbA2Yg.EzDnaezTcKcJKooedjzf1tzFZs1eqVJwipRWDjDHJ7svXDpm6C.SeyJ0IjoiZG0iLCJzIjp7InVyaSI6Imh0dHBzOi8vbG9jYWxob3N0OjcwMzcvIiwiYWNjZXB0IjpbImRpZGNvbW0vdjIiLCJkaWRjb21tL2FpcDI7ZW52PXJmYzU4NyJdLCJyb3V0aW5nX2tleXMiOlsiZGlkOnBlZXI6Mi5WejZNa3Y1cGNtRXN6a3A0dExmQXZIZk14TUU3R1R3VnNwdUVURG9uOUMyTFh5UzQ5LkV6RG5hZXBjdmNRaWZFdUdrdGpGYXpaMUZNVHpFTGY2aFdXY1dvRmFRZFRKclI4OUx6LlNleUowSWpvaVpHMGlMQ0p6SWpwN0luVnlhU0k2SW1oMGRIQnpPaTh2Ykc5allXeG9iM04wT2pjd016Y3ZJaXdpWVdOalpYQjBJanBiSW1ScFpHTnZiVzB2ZGpJaVhTd2ljbTkxZEdsdVoxOXJaWGx6SWpwYlhYMTkja2V5LTIiXX19
    </code>
    <h3>Mediator</h3>
    Affinidi offers a mediator node that can be used to route messages between two parties. Bob uses this mediator
    to
    receive messages.<br>
    This mediator is referenced in Bob's DID Document via a defined service for DIDComm messaging. The Mediator's
    DID
    contains:
    <ul>1. Verification key that is used for signing of messages for non-repudiation</ul>
    <ul>2. Encryption key that is used for encryption of messages that are sent to Bob</ul>
    <ul>3. Service definition that shares the address for Affinidi Secure Messaging</ul>
    <h4>Example Mediator DID&ensp;<button onclick="copyDid('mediator-did')">Copy DID</button></h4>
    <code id="mediator-did">
        did:peer:2.Vz6Mkv5pcmEszkp4tLfAvHfMxME7GTwVspuETDon9C2LXyS49.EzDnaepcvcQifEuGktjFazZ1FMTzELf6hWWcWoFaQdTJrR89Lz.SeyJ0IjoiZG0iLCJzIjp7InVyaSI6Imh0dHBzOi8vbG9jYWxob3N0OjcwMzcvIiwiYWNjZXB0IjpbImRpZGNvbW0vdjIiXSwicm91dGluZ19rZXlzIjpbXX19
    </code>
</body>

</html>